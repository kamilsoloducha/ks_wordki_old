version: '3'
services:
 wordki:
  container_name: wordki_e2e
  image: wordki_e2e
  build:
   context: ../../
   dockerfile: ./tests/Wordki.Tests.E2E/Dockerfile
  links:
   - mysql
  env_file:
   - secrets.E2E.env
  environment:
   - WAIT_HOSTS=mysql_e2e:3306
   - WAIT_HOSTS_TIMEOUT=60
   - WAIT_BEFORE_HOSTS=10
   - WAIT_SLEEP_INTERVAL=5
 mysql:
  container_name: mysql_e2e
  image: mysql/mysql-server:latest
  restart: always
  ports:
   - "3306:3306"
  volumes:
   - dbvol:/var/lib/mysql
  env_file:
   - secrets.E2E.env
  command: mysqld --character-set-server=utf8 --collation-server=utf8_general_ci
volumes:
 dbvol:
  external: false
